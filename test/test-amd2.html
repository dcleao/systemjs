<!doctype html>

<meta charset="utf-8">
<script>
	if (typeof Promise === 'undefined')
		document.write('<script src="../node_modules/bluebird/js/browser/bluebird.core.js"><\/script>');
</script>
<script>
	if (typeof fetch === 'undefined')
		document.write('<script src="../node_modules/whatwg-fetch/fetch.js"><\/script>');
</script>
<script defer src="../node_modules/construct-style-sheets-polyfill/dist/adoptedStyleSheets.js"></script>
<script>
	// TODO IE11 URL polyfill testing
	// if (typeof URL === 'undefined')
	//	document.write()
</script>

<link rel="stylesheet" type="text/css" href="../node_modules/mocha/mocha.css"/>
<script src="../node_modules/mocha/mocha.js"></script>

<script src="../dist/system.js"></script>
<script src="../dist/extras/use-default.js"></script>
<script src="../dist/extras/amd2.js"></script>
<script src="../dist/extras/named-register.js"></script>

<script>
  mocha.setup('tdd');

  self.baseURL = location.href.substr(0, location.href.lastIndexOf('/') + 1);
  self.rootURL = location.href.substr(0, location.href.substr(0, location.href.lastIndexOf('/')).lastIndexOf('/') + 1);
  self.assert = {
    ok: function (val) {
      this.equal(!!val, true);
    },
    equal: function equal(a, b) {
      if (a !== b)
        throw new Error('Expected "' + a + '" to be "' + b + '"');
    },
    fail: function (msg) {
      throw new Error(msg);
    }
  };

  System.import("./browser/amd2.js")
    .then(function() {
      mocha.run(function(failures) {
        fetch(failures ? "/error" : "/done");
      });
    });
</script>

<div id="mocha"></div>
